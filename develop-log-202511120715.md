# 開發紀錄 — 2025-11-12 07:15

## Backend
- 新增 `media_files` 與 `content_media` 資料表 (model + Alembic migration)，並在內容儲存/刪除時同步維護引用。
- 上傳 API (`/api/uploads`) 支援 500KB 限制，會寫入 `media_files`，回傳 `{id,url,...}`，並於 `/uploads` 靜態提供檔案。
- 新增 `/api/media` 列表與刪除 API；刪除時若仍被內容引用會回傳 400，避免破圖。
- FastAPI 主程式 `app/main.py` 掛載 static uploads 與 media router。

## Frontend
- 內容管理：TipTap 取代 textarea，支援拖拉/上傳圖片、Markdown 模式、SEO 欄位移至內容下方，封面圖自動取第一張圖片。
- 新增 Media Library 頁面，可檢視檔案大小、引用次數、複製連結、刪除未引用圖片。
- TipTap 工具列加入「媒體庫」按鈕，彈窗列出 `/api/media`，可直接插入既有圖片；插入/上傳皆會自動補上 `VITE_API_BASE`。
- Slug 會依標題自動產生拼音，使用者一旦手動修改便不再覆寫。

## Notes
- 現在上傳任何圖片都會記錄使用情況，Media Library 可安全刪除未引用檔案；若資料庫是用 `Base.metadata.create_all` 先建的，要先 `alembic stamp head` 再 `alembic upgrade head`。
- 下一步若要進一步控管媒體 (ex: 替換圖片或搬到 S3) 可在既有結構上擴充。
